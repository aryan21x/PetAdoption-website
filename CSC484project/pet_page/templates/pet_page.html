{% extends 'base.html' %}
{% load static%}
{% block title %} Home {% endblock %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pets</title>
</head>
<body class="backGround color-orange">
    <div class="d-flex align-items-center">
        <h1 class="d-inline">Pets</h1>
        <button id="toggleOn" class="btn btn-primary ml-3">Add Pet</button>
    </div>
    
    <form id="petForm" method="post">
        {% csrf_token %}
        <div class="form-row">
            <div class="form-group col-md-3">
                <label for="name">Name:</label>
                <input type="text" class="form-control" id="name2" name="name2" required>
            </div>
            <div class="form-group col-md-3">
                <label for="breed">Breed:</label>
                <input type="text" class="form-control" id="breed2" name="breed2" required>
            </div>
            <div class="form-group col-md-3">
                <label for="species">Species:</label>
                <input type="text" class="form-control" id="species2" name="species2" required>
            </div>
            <div class="form-group col-md-3">
                <label for="age">Age:</label>
                <input type="text" class="form-control" id="age2" name="age2" required>
            </div>
        </div>
        <!-- Additional parameters -->
        <div class="form-row">
            <div class="form-group col-md-3">
                <label for="worker_id">Worker ID:</label>
                <input type="text" class="form-control" id="worker_id2" name="worker_id2">
            </div>
            <div class="form-group col-md-3">
                <label for="location">Location ID:</label>
                <input type="text" class="form-control" id="location" name="location">
            </div>
            <div class="form-group col-md-3">
                <label for="adopted">Adopted:</label><br>
                <input type="checkbox" id="adopted" name="adopted" value="adopted">
                <label for="adopted">Adopted</label>
            </div>
        </div>
        <!-- Buttons -->
        <div class="d-inline">
            <button type="submit" class="btn btn-primary mr-2">Add Pet</button>
            <button id="toggleoff" class="btn btn-primary">Cancel</button>
        </div>
    </form>
    <form method="get" action="{% url 'sort_pet' %}">
        {% csrf_token %}
        <div class="form-row">
            <div class="form-group col-md-3">
                <label for="name">Name:</label>
                <input type="text" class="form-control" id="name" name="name" value="{{ request.GET.name }}">
            </div>
            <div class="form-group col-md-3">
                <label for="breed">Breed:</label>
                <input type="text" class="form-control" id="breed" name="breed" value="{{ request.GET.breed }}">
            </div>
            <div class="form-group col-md-3">
                <label for="breed">Worker Id:</label>
                <input type="text" class="form-control" id="worker_id" name="worker_id" value="{{ request.GET.worker_id }}">
            </div>
            <div class="form-group col-md-3">
                <label for="species">Species:</label>
                <input type="text" class="form-control" id="species" name="species" value="{{ request.GET.species }}">
            </div>
            <div class="form-group col-md-3">
                <label for="age">Age:</label>
                <input type="number" class="form-control" id="age" name="age" value="{{ request.GET.age }}">
            </div>
        </div>
        <div class="form-group">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" id="adopted_needs_home" name="adopted_needs_home" {% if request.GET.adopted == "0" %} checked {% endif %}>
                <label class="form-check-label" for="adopted_needs_home">Needs a Home</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" id="adopted_adopted" name="adopted_adopted" {% if request.GET.adopted == "1" %} checked {% endif %}>
                <label class="form-check-label" for="adopted_adopted">Adopted</label>
            </div>
        </div>
        <div class="d-flex align-items-center">
            <button type="submit" class="btn btn-primary mr-2">
                <i class="fas fa-search"></i>
            </button>
            <button id="clearFilter" type="submit" class="btn btn-primary mr-2">Clear</button>
        </div>
        
    </form>
    
    <table class="table table-hover bold">
        <thead class="thread-orange">
            <tr>
                <th>Image</th>
                <th>Name</th>
                <th>Breed</th>
                <th>Worker Id</th>
                <th>Species</th>
                <th>Age</th>
                <th>Adopted</th>
                <th  colspan="2">Actions</th>
            </tr>
        </thead>
        <tbody class="t-orange">
            {% for pet in pets %}
            <tr>
                {% if pet.image_path %}
                    <td><img src="{{ pet.image_path }}" alt="Image" class="rounded-circle" style="width: 50px; height: 50px;"></td>
                {% else %}
                    <td><img src="{% static 'images/default.jpg' %}" alt="Default Image" class="rounded-circle" style="width: 50px; height: 50px;"></td>
                {% endif %}
                <td>{{ pet.name }}</td>
                <td>{{ pet.breed }}</td>
                <td>{{ pet.worker_id }}</td>
                <td>{{ pet.species }}</td>
                <td>{{ pet.age }}</td>
                <td>
                    {% if pet.adoptered == 1 %}
                        Adopted by Adopter {{pet.adopt_id}}
                    {% else %}
                        Needs a Home at Shelter {{pet.shelter_id}}
                    {% endif %}
                </td>
                <td>
                    <form method="get" action="{% url 'edit_pet' pet.pet_id %}">
                      {% csrf_token %}
                      <input type="submit" class="btn btn-primary btn-sm" value="Edit">
                    </form>
                </td>
                <td>
                    <form method="post" action="{% url 'delete_pet' pet.pet_id %}">
                      {% csrf_token %}
                      <input type="submit" class="btn btn-danger btn-sm" value="Delete">
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>

<style>
    .nav-link::before {
        background-color: orange !important;
    }
    #petForm{
        display:none;
    }
    .nav-link {
        color: orange !important;
    }
</style>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const form = document.getElementById("petForm");
        const toggleButton = document.getElementById("toggleOn");
        const cancelButton = document.getElementById("toggleoff");
        const clearFilterButton = document.getElementById("clearFilter");

        toggleButton.addEventListener("click", function() {
            if (form.style.display === "none") {
                form.style.display = "block";
                toggleButton.style.display = "none";
            } else {
                form.style.display = "none";
            }
        });

        cancelButton.addEventListener("click", function() {
            form.style.display = "none";
            toggleButton.style.display = "block";
        });
        
        clearFilterButton.addEventListener("click", function() {
            document.getElementById("name").value = "";
            document.getElementById("breed").value = "";
            document.getElementById("species").value = "";
            document.getElementById("age").value = "";
            document.getElementById("worker_id").value = ""; // Clear worker ID input
            document.getElementById("adopted_needs_home").checked = false; // Uncheck adopted checkboxes
            document.getElementById("adopted_adopted").checked = false;
        });
    });
</script>
{% endblock %}
